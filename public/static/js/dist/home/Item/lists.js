$(function(){$(".j-qrcode").click(function(){var a=$(this).data("id");HYD.showQrcode("/Item/rwcode/item_id/"+a)}),$(".j-del").click(function(){var a=$(this).data("id");return $.jBox.show({title:"提示",content:_.template($("#tpl_jbox_simple").html(),{content:"删除后将不可恢复，是否继续？"}),btnOK:{onBtnClick:function(b){$.jBox.close(b),$.ajax({url:"/Item/delItem",type:"post",dataType:"json",data:{id:a},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，删除成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，删除失败："+a.msg),$.jBox.hideloading()}})}}}),!1}),$(".btn_table_delAll").click(function(){var a=[],b=$(".table-ckbs:checked");return b.each(function(){a.push($(this).data("id"))}),a.length?($.jBox.show({title:"提示",content:_.template($("#tpl_jbox_simple").html(),{content:"删除后将不可恢复，是否继续？"}),btnOK:{onBtnClick:function(c){$.jBox.close(c),$.ajax({url:"/Item/batch_action",type:"post",dataType:"json",data:{id:a,action:"del_item"},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(b.parents("tr").fadeOut(300,function(){HYD.hint("success","恭喜您，删除成功！")}),setTimeout(function(){window.location.reload()},300)):HYD.hint("danger","对不起，删除失败："+a.msg),$.jBox.hideloading()}})}}}),!1):void HYD.hint("warning","对不起，请选择要删除的数据！")}),$(".j-offshelf").click(function(){var a=$(this).data("id");return $.jBox.show({title:"提示",content:_.template($("#tpl_jbox_simple").html(),{content:"确认要下架此产品吗？"}),btnOK:{onBtnClick:function(b){$.jBox.close(b),$.ajax({url:"/Item/offshelf",type:"post",dataType:"json",data:{id:a},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，操作成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，操作失败："+a.msg),$.jBox.hideloading()}})}}}),!1}),$(".btn_table_offshelf").click(function(){var a=[],b=$(".table-ckbs:checked");return b.each(function(){a.push($(this).data("id"))}),a.length?($.jBox.show({title:"提示",content:_.template($("#tpl_jbox_simple").html(),{content:"您确认要下架吗？"}),btnOK:{onBtnClick:function(c){$.jBox.close(c),$.ajax({url:"/Item/batch_action",type:"post",dataType:"json",data:{id:a,action:"store_item"},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(b.parents("tr").fadeOut(300,function(){HYD.hint("success","恭喜您，操作成功！")}),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，操作失败："+a.msg),$.jBox.hideloading()}})}}}),!1):void HYD.hint("warning","对不起，请选择要下架的数据！")}),$(".j-recommend").click(function(){var a=$(this).data("id");return $.jBox.show({title:"提示",content:_.template($("#tpl_jbox_simple").html(),{content:"确认要将此产品置顶吗？"}),btnOK:{onBtnClick:function(b){$.jBox.close(b),$.ajax({url:"/Item/ajaxItemRecommon",type:"post",dataType:"json",data:{id:a,type:"recommon"},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，操作成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，操作失败："+a.msg),$.jBox.hideloading()}})}}}),!1}),$(".j-commend").click(function(){var a=$(this).data("id");return $.jBox.show({title:"提示",content:_.template($("#tpl_jbox_simple").html(),{content:"确认要将此产品取消置顶吗？"}),btnOK:{onBtnClick:function(b){$.jBox.close(b),$.ajax({url:"/Item/ajaxItemRecommon",type:"post",dataType:"json",data:{id:a,type:"common"},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，操作成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，操作失败："+a.msg),$.jBox.hideloading()}})}}}),!1}),$(".btn_table_onshelf").click(function(){var a=[],b=$(".table-ckbs:checked");return b.each(function(){a.push($(this).data("id"))}),a.length?($.jBox.show({title:"提示",content:_.template($("#tpl_jbox_simple").html(),{content:"您确认要上架吗？"}),btnOK:{onBtnClick:function(c){$.jBox.close(c),$.ajax({url:"/Item/batch_action",type:"post",dataType:"json",data:{id:a,action:"display_item"},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(b.parents("tr").fadeOut(300,function(){HYD.hint("success","恭喜您，操作成功！")}),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，操作失败："+a.msg),$.jBox.hideloading()}})}}}),!1):void HYD.hint("warning","对不起，请选择要上架的数据！")}),$(".btn_table_groupAll").click(function(){var a=[],b=$(".table-ckbs:checked");return b.each(function(){a.push($(this).data("id"))}),a.length?($.jBox.show({title:"提示",content:_.template($("#tpl_group_all").html(),{content:"请选择产品分组："}),btnOK:{onBtnClick:function(c){$.jBox.close(c);var d=[];c.find(".J-group_ids:checked").each(function(a){d.push($(this).val())}),$.ajax({url:"/Item/edit_group_all",type:"post",dataType:"json",data:{id:a,group_ids:d},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(b.parents("tr").fadeOut(300,function(){HYD.hint("success","恭喜您，操作成功！")}),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，操作失败："+a.msg),$.jBox.hideloading()}})}}}),!1):void HYD.hint("warning","对不起，请选择要分组的产品！")}),$(".btn_table_setLevel").click(function(){var a=[],b=$(".table-ckbs:checked");return b.each(function(){a.push($(this).data("id"))}),a.length?($.jBox.show({title:"提示",content:_.template($("#tpl_level").html()),btnOK:{onBtnClick:function(c){$.jBox.close(c);var d=c.find("input[name='join_level_discount']:checked").val();$.ajax({url:"/Item/join_level_discount",type:"post",dataType:"json",data:{id:a,join_level_discount:d},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(b.parents("tr").fadeOut(300,function(){HYD.hint("success",a.msg)}),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，操作失败："+a.msg),$.jBox.hideloading()}})}}}),!1):void HYD.hint("warning","对不起，请选择要批量开启或关闭会员等级折扣的产品！")}),$(".j-comment").click(function(){var a=$(this).data("id");$.jBox.show({title:"添加评论",content:_.template($("#tpl_comment").html()),btnOK:{onBtnClick:function(b){$.jBox.close(b);var c=b.find("textarea[name='detail']").val(),d=b.find("input[name='user_name']").val(),e=b.find(".j-imglist-dataset").val(),f=b.find("input[name='create_time']").val();$.ajax({url:"/Item/ajax_comment",type:"post",dataType:"json",beforeSend:function(){$.jBox.showloading()},data:{type_id:a,detail:c,user_name:d,file_path:e,create_time:f},success:function(a){1==a.status?(HYD.hint("success","恭喜，操作成功"+a.msg),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，操作失败"+a.msg),$.jBox.hideloading()}})}}})}),$(document).on("click",".img-list-add",function(){HYD.popbox.ImgPicker(function(a){for(var b="",c=$(".j-imglist-dataset").val(),d=0;d<a.length;d++)b+='<li><img src="'+a[d]+'"></li>',c+=a[d]+";";$(".img-list").prepend(b),$(".j-imglist-dataset").val(c)})}),$(".intem").click(function(){$(this).addClass("cur").siblings().removeClass("cur");var a=parseInt($(this).text());$.post("/Item/lists",{pagelist:a},function(a){window.location.href=""})}),$(".j-update").click(function(){var a=$(this).data("id");$.jBox.show({title:"同步淘宝",content:"确认同步吗？",btnOK:{onBtnClick:function(b){$.jBox.close(b),$.ajax({url:"/Item/updata_taobao_item",type:"post",dataType:"json",beforeSend:function(){$.jBox.showloading()},data:{id:a},success:function(a){1==a.status?(HYD.hint("success","恭喜，操作成功"+a.msg),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，操作失败"+a.msg),$.jBox.hideloading()}})}}})}),$(".j_alibaba").click(function(){var a=[],b=$(".table-ckbs:checked");return b.each(function(){a.push($(this).data("id"))}),a.length?($.jBox.show({title:"提示",content:_.template($("#tpl_import_item").html()),btnOK:{onBtnClick:function(c){$.jBox.close(c);var d=c.find("select[name='shop_id']").val();$.ajax({url:"/Item/export_item_alibaba",type:"post",dataType:"json",data:{ids:a,shop_id:d},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(b.parents("tr").fadeOut(300,function(){HYD.hint("success","恭喜您，导入成功"+a.data.success+"条，导入失败"+a.data.fail+"条")}),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，操作失败："+a.msg),$.jBox.hideloading()}})}}}),!1):void HYD.hint("warning","对不起，请选择要导入的产品！")}),$(".j_postfee").click(function(){var a=[],b=$(".table-ckbs:checked");if(b.each(function(){a.push($(this).data("id"))}),!a.length)return void HYD.hint("warning","对不起，请选择要设置运费的产品！");var c=$("#tpl_post_fee").html(),d=$(c);return d.change(".j-feight",function(){var a=$(".j-feight-ipt"),b=$("#freight_tpl_id"),c=d.find(".j-feight:checked").val();switch(c){case"1":a.attr("disabled",!0),b.attr("disabled",!0);break;case"2":a.attr("disabled",!1),b.attr("disabled",!0);break;case"3":a.attr("disabled",!0),b.attr("disabled",!1)}}),$.jBox.show({title:"批量设置运费",content:d,btnOK:{onBtnClick:function(c){var e=d.find('input[name="freight_payer"]:checked'),f=d.find('input[name="post_fee"]'),g=d.find('select[name="freight_tpl_id"]'),h=e.val(),i=parseFloat(f.val()),j=g.val();if(2==h){if(isNaN(i)||0==i)return void HYD.FormShowError(f,"请填写正确的邮费")}else if(3==h&&0==j)return void HYD.FormShowError(g,"请选择运费模版");console.log(j),$.jBox.close(c),$.ajax({url:"/Item/setPostFee",type:"post",dataType:"json",data:{id:a,freight_payer:h,post_fee:i,freight_tpl_id:j},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(b.parents("tr").fadeOut(300,function(){HYD.hint("success","恭喜您，操作成功！")}),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，操作失败："+a.msg),$.jBox.hideloading()}})}}}),!1}),$(".j-copyitem").click(function(){var a=$(this).data("id");return $.jBox.show({title:"提示",content:_.template($("#tpl_jbox_simple").html(),{content:"复制后,将会发布一款相同的产品,确认复制吗？"}),btnOK:{onBtnClick:function(b){$.jBox.close(b),$.ajax({url:"/Item/copyItem",type:"post",dataType:"json",data:{id:a},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(HYD.hint("success","恭喜您，复制成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，复制失败："+a.msg),$.jBox.hideloading()}})}}}),!1}),$(".batch_update_price").click(function(){var a=[],b=$(".table-ckbs:checked");if(b.each(function(){a.push($(this).data("id"))}),!a.length)return void HYD.hint("warning","对不起，请选择要修改价格的产品！");var c=$("#tpl_item_price").html(),d=$(c);return $.jBox.show({title:"批量修改价格",content:d,btnOK:{onBtnClick:function(c){var d=c.find('input[name="price"]').val(),e=c.find('select[name="type"]').val(),f=c.find('input[name="fixedPrice"]').val();$.jBox.close(c),$.ajax({url:"/Item/batchUpdatePrice",type:"post",dataType:"json",data:{ids:a,price:d,type:e,fixedPrice:f},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(b.parents("tr").fadeOut(300,function(){HYD.hint("success","恭喜您，修改成功！")}),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，修改失败："+a.msg),$.jBox.hideloading()}})}}}),!1}),$(".batch_update_class").click(function(){var a=[],b=$(".table-ckbs:checked");if(b.each(function(){a.push($(this).data("id"))}),!a.length)return void HYD.hint("warning","对不起，请选择要修改分类的产品！");var c=$("#tpl_item_class").html(),d=$(c);return $.jBox.show({title:"批量修改分类",content:d,btnOK:{onBtnClick:function(c){var d=c.find('select[name="class_id"]').val();$.jBox.close(c),$.ajax({url:"/Item/batchUpdateClass",type:"post",dataType:"json",data:{ids:a,class_id:d},beforeSend:function(){$.jBox.showloading()},success:function(a){1==a.status?(b.parents("tr").fadeOut(300,function(){HYD.hint("success","恭喜您，修改成功！")}),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，修改失败："+a.msg),$.jBox.hideloading()}})}}}),!1})});